<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe de Gesti√≥n | Sistema Quijano</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

    <style>
        :root {
            --corp-dark: #0f172a;  /* Navy Premium */
            --corp-blue: #1e40af;  /* Azul Institucional */
            --corp-gold: #b45309;  /* Dorado Serio */
            --corp-gray: #f1f5f9;
            --risk: #ef4444; 
            --warn: #f59e0b;
            --safe: #10b981;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #cbd5e1;
            margin: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            color: var(--corp-dark);
        }

        /* --- ARQUITECTURA DE P√ÅGINA (A4 IMPRESI√ìN PERFECTA) --- */
        .page {
            background: white;
            width: 21cm;
            height: 29.7cm; /* Altura fija A4 */
            position: relative;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        /* --- P√ÅGINA 1: PORTADA DE ALTO IMPACTO --- */
        .cover-page {
            background: linear-gradient(180deg, #0f172a 0%, #1e293b 80%, #1e40af 100%);
            color: white;
            padding: 3cm;
            justify-content: center;
        }
        .cover-content { position: relative; z-index: 2; text-align: center; }
        .cover-logo { height: 120px; margin-bottom: 40px; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.3)); }
        .cover-title { font-size: 42px; font-weight: 800; letter-spacing: -1px; margin-bottom: 10px; line-height: 1.1; }
        .cover-sub { font-size: 16px; font-weight: 300; opacity: 0.8; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 60px; }
        .cover-strip { width: 100px; height: 4px; background: var(--corp-gold); margin: 0 auto 40px auto; }
        
        .cover-footer { 
            position: absolute; bottom: 2cm; left: 0; right: 0; 
            text-align: center; font-size: 11px; opacity: 0.6; 
            border-top: 1px solid rgba(255,255,255,0.1); 
            padding-top: 20px; width: 80%; margin: 0 auto;
        }

        /* --- P√ÅGINA 2: CARTA ADMINISTRATIVA (FORMAL) --- */
        .letter-page { padding: 2.5cm; }
        .letter-header { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid var(--corp-dark); padding-bottom: 15px; margin-bottom: 40px; }
        .letter-title { font-size: 18px; font-weight: 700; text-transform: uppercase; color: var(--corp-blue); }
        .letter-meta { font-size: 11px; text-align: right; color: #64748b; }
        
        .letter-body { font-size: 13px; line-height: 1.8; text-align: justify; color: #334155; }
        .letter-body p { margin-bottom: 20px; }
        
        .signature-block { margin-top: 3cm; }
        .sign-line { width: 250px; border-bottom: 1px solid #0f172a; margin-bottom: 10px; }

        /* --- P√ÅGINA 3: MATRIZ DE RESULTADOS (S√ÅBANA) --- */
        .matrix-page { padding: 1.5cm; display: block; } /* Block para permitir tabla larga */
        
        .section-header { 
            background: #f8fafc; border-left: 5px solid var(--corp-blue); 
            padding: 15px; margin-bottom: 20px; border-radius: 0 8px 8px 0; 
        }
        .section-header h2 { margin: 0; font-size: 16px; text-transform: uppercase; color: var(--corp-dark); }
        .section-header span { font-size: 11px; color: #64748b; }

        .data-table { width: 100%; border-collapse: collapse; font-size: 10px; }
        .data-table th { 
            background: var(--corp-dark); color: white; padding: 8px; 
            text-align: center; font-weight: 600; text-transform: uppercase;
        }
        .data-table td { padding: 6px; border-bottom: 1px solid #e2e8f0; text-align: center; }
        .data-table tr:nth-child(even) { background: #f8fafc; }
        .col-name { text-align: left !important; font-weight: 600; color: var(--corp-dark); }
        
        /* FILA DE TOTALES */
        .row-total { background: #e2e8f0 !important; font-weight: 800; border-top: 2px solid var(--corp-dark); }
        
        /* Colores Heatmap */
        .bg-crit { background: #fecaca; color: #991b1b; border-radius: 4px; padding: 2px 5px; }
        .bg-warn { background: #fde68a; color: #92400e; border-radius: 4px; padding: 2px 5px; }
        .bg-good { background: #bbf7d0; color: #166534; border-radius: 4px; padding: 2px 5px; }

        /* --- P√ÅGINA 4: AN√ÅLISIS POR √ÅREA (PERFORMANCE DOCENTE) --- */
        .charts-page { padding: 1.5cm; }
        .chart-grid { display: grid; grid-template-columns: 1fr; gap: 30px; height: 100%; }
        
        .area-card { 
            border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        
        /* Torta 3D (Simulada) */
        .donut-container { position: relative; height: 250px; width: 100%; display: flex; justify-content: center; }
        .donut-center { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; font-size: 24px; font-weight: 800; color: var(--corp-dark);
        }

        /* --- P√ÅGINA 5: DICTAMEN T√âCNICO (DESCRIPTIVO) --- */
        .analysis-page { padding: 2cm; }
        .analysis-box {
            background: white; border-left: 4px solid var(--corp-gray);
            padding: 0 0 0 20px; margin-bottom: 30px;
        }
        .analysis-box h3 { margin: 0 0 10px 0; font-size: 14px; color: var(--corp-blue); text-transform: uppercase; }
        .analysis-text { font-size: 12px; color: #475569; line-height: 1.6; text-align: justify; }

        /* --- PRINT SETTINGS --- */
        @media print {
            body { background: white; padding: 0; gap: 0; }
            .page { margin: 0; width: 100%; height: 100%; box-shadow: none; page-break-after: always; }
            .page:last-child { page-break-after: auto; }
            .fab-print { display: none; }
            .bg-crit, .bg-warn, .bg-good, .cover-page { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }

        /* Bot√≥n */
        .fab-print {
            position: fixed; bottom: 30px; right: 30px; background: var(--corp-blue); color: white;
            padding: 15px 30px; border-radius: 50px; font-weight: 700; cursor: pointer; border: none;
            box-shadow: 0 10px 20px rgba(30, 64, 175, 0.4); z-index: 999;
        }
    </style>
</head>
<body>

    <div class="page cover-page">
        <div class="cover-content">
            <img src="https://raw.githubusercontent.com/profeangel96-bit/PLANTILLA/main/Gemini_Generated_Image_24c84124c84124c8.png" class="cover-logo">
            <div class="cover-title">INFORME DE GESTI√ìN<br>Y RESULTADOS</div>
            <div class="cover-strip"></div>
            <div class="cover-sub">AN√ÅLISIS DE CALIDAD EDUCATIVA | SIMULACRO S-11</div>
        </div>
        <div class="cover-footer">
            DOCUMENTO T√âCNICO GENERADO POR SISTEMA DE INTELIGENCIA QUIJANO<br>
            CONFIDENCIAL ‚Ä¢ USO EXCLUSIVO ADMINISTRATIVO
        </div>
    </div>

    <div class="page letter-page">
        <div class="letter-header">
            <div class="letter-title">Radicado T√©cnico N¬∞ <span id="radicado">2026-001</span></div>
            <div class="letter-meta">
                <strong>FECHA:</strong> 16 de Enero de 2026<br>
                <strong>ASUNTO:</strong> Entrega Oficial de Resultados
            </div>
        </div>
        <div class="letter-body">
            <p><strong>A la atenci√≥n de la Rector√≠a y Coordinaci√≥n Acad√©mica:</strong></p>
            <p>
                En cumplimiento con el contrato de consultor√≠a externa para el fortalecimiento de la calidad educativa, 
                la <strong>Academia Quijano</strong> hace entrega formal del consolidado de resultados correspondiente al Simulacro S-11.
            </p>
            <p>
                Este documento t√©cnico tiene como objetivo proporcionar a la administraci√≥n los indicadores cuantitativos 
                necesarios para la evaluaci√≥n del desempe√±o docente y estudiantil. La informaci√≥n contenida en las siguientes 
                p√°ginas desglosa el rendimiento por √°reas del n√∫cleo com√∫n, permitiendo identificar fortalezas institucionales 
                y focos de atenci√≥n prioritaria.
            </p>
            <p>
                Se anexa la matriz detallada de puntajes, el an√°lisis comparativo por asignatura y el dictamen descriptivo 
                de la distribuci√≥n poblacional del grado 11.
            </p>
            <p>Atentamente,</p>
        </div>
        <div class="signature-block">
            <div class="sign-line"></div>
            <strong>JUAN √ÅNGEL RODR√çGUEZ BASANTE</strong><br>
            <span style="font-size: 11px; color: #64748b;">Director de Operaciones<br>Academia Quijano</span>
        </div>
    </div>

    <div class="page matrix-page">
        <div class="section-header">
            <h2>Matriz Consolidada de Desempe√±o</h2>
            <span>DESGLOSE INDIVIDUAL Y PROMEDIOS DE √ÅREA</span>
        </div>

        <table class="data-table">
            <thead>
                <tr>
                    <th style="width: 30px;">#</th>
                    <th style="width: 250px;">Apellidos y Nombres</th>
                    <th>LEC</th>
                    <th>MAT</th>
                    <th>SOC</th>
                    <th>CIE</th>
                    <th>ING</th>
                    <th>GLOBAL</th>
                </tr>
            </thead>
            <tbody id="table-body">
                </tbody>
            <tfoot>
                <tr class="row-total" id="table-footer">
                    </tr>
            </tfoot>
        </table>
        
        <div style="margin-top: 20px; font-size: 10px; color: #64748b;">
            * Nota: Los colores indican el rango de desempe√±o (Rojo: 0-45, Amarillo: 46-65, Verde: 66-100).
            El promedio de √°rea permite evaluar la eficacia de la metodolog√≠a docente en el periodo actual.
        </div>
    </div>

    <div class="page charts-page">
        <div class="section-header">
            <h2>Indicadores de Gesti√≥n por Asignatura</h2>
            <span>EVALUACI√ìN DE EFICACIA DOCENTE Y DISTRIBUCI√ìN</span>
        </div>

        <div class="chart-grid">
            <div class="area-card">
                <h4 style="margin:0 0 15px 0; font-size:12px; text-transform:uppercase; color:var(--corp-dark);">Promedio Acumulado por √Årea</h4>
                <div style="height: 200px;">
                    <canvas id="barChart"></canvas>
                </div>
            </div>

            <div class="area-card" style="display: flex; flex-direction: column; align-items: center;">
                <h4 style="margin:0 0 15px 0; font-size:12px; text-transform:uppercase; color:var(--corp-dark);">Distribuci√≥n Poblacional (Global)</h4>
                <div class="donut-container">
                    <canvas id="donutChart"></canvas>
                    <div class="donut-center" id="total-students">0</div>
                </div>
                <div style="font-size: 10px; color: #64748b; margin-top: 10px;">Total Estudiantes Evaluados</div>
            </div>
        </div>
    </div>

    <div class="page analysis-page">
        <div class="section-header">
            <h2>Dictamen T√©cnico Descriptivo</h2>
            <span>AN√ÅLISIS DE DATOS OBSERVADOS</span>
        </div>

        <div class="analysis-box">
            <h3>1. Comportamiento en Lectura Cr√≠tica</h3>
            <p class="analysis-text" id="desc-lec">
                Se evidencia que el <span id="perc-lec">0%</span> de la poblaci√≥n estudiantil se encuentra en el rango superior. 
                La media aritm√©tica del grupo se sit√∫a en <span id="avg-lec-txt">0</span> puntos. 
                No se observan desviaciones at√≠picas significativas en este componente.
            </p>
        </div>

        <div class="analysis-box">
            <h3>2. Comportamiento en Matem√°ticas y Ciencias</h3>
            <p class="analysis-text" id="desc-mat">
                Los datos recolectados muestran una concentraci√≥n de resultados en el cuartil medio-bajo. 
                El puntaje promedio de Matem√°ticas (<span id="avg-mat-txt">0</span>) es inferior al promedio institucional general. 
                Ciencias Naturales presenta una dispersi√≥n mayor entre los puntajes m√°s altos y los m√°s bajos.
            </p>
        </div>

        <div class="analysis-box">
            <h3>3. Competencia en Segunda Lengua (Ingl√©s)</h3>
            <p class="analysis-text" id="desc-ing">
                El √°rea de Ingl√©s registra el comportamiento m√°s estable del simulacro. 
                La mayor√≠a de estudiantes aprob√≥ el componente b√°sico, situando el promedio en <span id="avg-ing-txt">0</span>.
            </p>
        </div>

        <div style="margin-top: auto; border-top: 1px solid #0f172a; padding-top: 10px; font-size: 10px; text-align: center; opacity: 0.7;">
            FIN DEL INFORME T√âCNICO ‚Ä¢ SISTEMA DE GESTI√ìN DE CALIDAD QUIJANO
        </div>
    </div>

    <button class="fab-print" onclick="window.print()">üñ®Ô∏è IMPRIMIR OFICIAL</button>

    <script>
        // --- 1. DATOS SIMULADOS (ESTO LO LLENA GOOGLE SHEETS) ---
        // En producci√≥n, Sheets reemplaza este array con datos reales
        const students = [
            { name: "AGUIRRE DAVILA DANA", l: 71, m: 68, s: 70, c: 75, i: 80, g: 364 },
            { name: "ANACONA BOLA√ëOS ANDRES", l: 65, m: 50, s: 60, c: 55, i: 45, g: 275 },
            { name: "ARCOS NANDAR OSCAR", l: 40, m: 30, s: 45, c: 50, i: 35, g: 200 },
            { name: "BENAVIDES SOFIA", l: 80, m: 78, s: 75, c: 82, i: 85, g: 400 },
            { name: "CAICEDO JUAN ESTEBAN", l: 55, m: 45, s: 50, c: 52, i: 40, g: 242 },
            { name: "CIFUENTES GABRIELA", l: 60, m: 55, s: 58, c: 60, i: 50, g: 283 },
            { name: "DIAZ JOHAN CAMILO", l: 35, m: 40, s: 38, c: 42, i: 30, g: 185 },
            { name: "GOMEZ PEDRO", l: 72, m: 70, s: 68, c: 70, i: 65, g: 345 },
            { name: "LOPEZ MARIA", l: 45, m: 48, s: 50, c: 45, i: 40, g: 228 },
            { name: "MARTINEZ LUIS", l: 68, m: 65, s: 62, c: 64, i: 60, g: 319 },
            // ... (M√°s datos se cargar√≠an aqu√≠)
        ];

        // --- 2. L√ìGICA DE TABLA Y TOTALES ---
        const tbody = document.getElementById('table-body');
        let sum = { l:0, m:0, s:0, c:0, i:0, g:0 };
        
        function getColor(v) {
            if(v <= 45) return 'bg-crit';
            if(v <= 65) return 'bg-warn';
            return 'bg-good';
        }

        students.forEach((s, i) => {
            sum.l += s.l; sum.m += s.m; sum.s += s.s; sum.c += s.c; sum.i += s.i; sum.g += s.g;
            
            let tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${i+1}</td>
                <td class="col-name">${s.name}</td>
                <td><span class="${getColor(s.l)}">${s.l}</span></td>
                <td><span class="${getColor(s.m)}">${s.m}</span></td>
                <td><span class="${getColor(s.s)}">${s.s}</span></td>
                <td><span class="${getColor(s.c)}">${s.c}</span></td>
                <td><span class="${getColor(s.i)}">${s.i}</span></td>
                <td><strong>${s.g}</strong></td>
            `;
            tbody.appendChild(tr);
        });

        // Calcular Promedios
        const count = students.length;
        const avg = {
            l: Math.round(sum.l/count), m: Math.round(sum.m/count),
            s: Math.round(sum.s/count), c: Math.round(sum.c/count),
            i: Math.round(sum.i/count), g: Math.round(sum.g/count)
        };

        // Pintar Fila de Totales
        document.getElementById('table-footer').innerHTML = `
            <td colspan="2" style="text-align:right; padding-right:10px;">PROMEDIO POR √ÅREA:</td>
            <td>${avg.l}</td> <td>${avg.m}</td> <td>${avg.s}</td> <td>${avg.c}</td> <td>${avg.i}</td> <td>${avg.g}</td>
        `;

        // Actualizar Textos Descriptivos
        document.getElementById('total-students').innerText = count;
        document.getElementById('avg-lec-txt').innerText = avg.l;
        document.getElementById('avg-mat-txt').innerText = avg.m;
        document.getElementById('avg-ing-txt').innerText = avg.i;

        // --- 3. GR√ÅFICOS (Chart.js) ---
        
        // A. Barras Horizontales (Ranking √Åreas)
        new Chart(document.getElementById('barChart'), {
            type: 'bar',
            data: {
                labels: ['LECTURA', 'SOCIALES', 'CIENCIAS', 'MATEM√ÅTICAS', 'INGL√âS'],
                datasets: [{
                    label: 'Puntaje Promedio',
                    data: [avg.l, avg.s, avg.c, avg.m, avg.i],
                    backgroundColor: [
                        '#1e40af', '#1e40af', '#1e40af', '#b45309', '#b45309' // Destacar las bajas en otro color si quieres
                    ],
                    borderRadius: 4,
                    barThickness: 20
                }]
            },
            options: {
                indexAxis: 'y', // Hace las barras horizontales
                plugins: { legend: { display: false } },
                scales: { x: { beginAtZero: true, max: 100, grid: { display: false } } }
            }
        });

        // B. Torta "Donut" 3D (Distribuci√≥n)
        // Simulamos 3 niveles: Bajo (<250), Medio (250-320), Alto (>320)
        let levels = { low:0, mid:0, high:0 };
        students.forEach(s => {
            if(s.g < 250) levels.low++;
            else if(s.g < 320) levels.mid++;
            else levels.high++;
        });

        new Chart(document.getElementById('donutChart'), {
            type: 'doughnut',
            data: {
                labels: ['Nivel Inicial', 'Nivel Medio', 'Nivel Avanzado'],
                datasets: [{
                    data: [levels.low, levels.mid, levels.high],
                    backgroundColor: ['#ef4444', '#f59e0b', '#10b981'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                cutout: '70%', // Hace el agujero grande para el n√∫mero
                plugins: { legend: { position: 'bottom', labels: { font: { size: 10 } } } }
            }
        });

        // Capturar par√°metros URL si existen (para conectar con Sheets)
        const p = new URLSearchParams(window.location.search);
        if(p.get('rad')) document.getElementById('radicado').innerText = p.get('rad');

    </script>
</body>
</html>
