<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe Estrat√©gico Oficial | Academia Quijano</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --brand-dark: #0f172a; /* Navy Profundo */
            --brand-blue: #2563eb; /* Azul El√©ctrico */
            --brand-gold: #d97706; /* Dorado Consultor */
            --risk-bg: #fee2e2; --risk-txt: #991b1b;
            --warn-bg: #fef9c3; --warn-txt: #854d0e;
            --safe-bg: #dcfce7; --safe-txt: #166534;
            --paper: #ffffff;
            --shadow-soft: 0 10px 40px -10px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #cbd5e1; /* Fondo gris para resaltar las hojas en pantalla */
            margin: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            color: var(--brand-dark);
        }

        /* --- ARQUITECTURA DE P√ÅGINA (A4 EXACTO) --- */
        .page {
            background: var(--paper);
            width: 21cm;
            height: 29.7cm; /* Altura fija A4 */
            padding: 0; /* Control total de m√°rgenes internos */
            position: relative;
            box-shadow: var(--shadow-soft);
            overflow: hidden; /* Para que el dise√±o no sangre mal */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        /* --- P√ÅGINA 1: PORTADA DE LUJO (Estilo Netflix ESG) --- */
        .cover-page {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            justify-content: space-between;
            padding: 3cm;
        }
        .cover-logo { width: 150px; margin-bottom: 2cm; }
        .cover-title { font-size: 48px; font-weight: 900; line-height: 1.1; letter-spacing: -1px; text-transform: uppercase; }
        .cover-subtitle { font-size: 18px; font-weight: 300; margin-top: 20px; opacity: 0.8; border-left: 4px solid var(--brand-gold); padding-left: 20px; }
        .cover-footer { border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px; font-size: 12px; display: flex; justify-content: space-between; }

        /* --- P√ÅGINA 2: PRESENTACI√ìN (Estilo Carta) --- */
        .intro-page { padding: 2.5cm; justify-content: center; }
        .intro-text { font-size: 14px; line-height: 1.8; text-align: justify; color: #334155; }
        .intro-signature { margin-top: 2cm; }
        .intro-quote { font-style: italic; color: var(--brand-blue); font-size: 18px; margin-bottom: 30px; font-weight: 600; text-align: center; }

        /* --- P√ÅGINA 3: RESUMEN EJECUTIVO (Dashboard) --- */
        .dashboard-page { padding: 2cm; }
        .dash-header { border-bottom: 2px solid #e2e8f0; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: flex-end; }
        
        .kpi-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 40px; }
        .kpi-card { background: #f8fafc; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; text-align: center; }
        .kpi-val { font-size: 42px; font-weight: 800; color: var(--brand-dark); }
        .kpi-lbl { font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: #64748b; font-weight: 700; }

        .chart-section { height: 350px; width: 100%; display: flex; justify-content: center; margin-bottom: 30px; }
        
        /* --- P√ÅGINA 4+: TABLA DE DATOS (Ingenier√≠a Pura) --- */
        .data-page { padding: 1.5cm; height: auto; min-height: 29.7cm; } /* Altura auto para que la tabla fluya si se imprime */
        
        .master-table { width: 100%; border-collapse: collapse; font-size: 11px; }
        
        /* Cabecera pegajosa para impresi√≥n */
        .master-table thead { display: table-header-group; } 
        .master-table tr { page-break-inside: avoid; } /* Evita cortar alumnos a la mitad */
        
        .master-table th { 
            background: var(--brand-dark); color: white; 
            padding: 10px; text-align: left; text-transform: uppercase; 
            font-size: 9px; letter-spacing: 0.5px;
        }
        .master-table td { padding: 8px 10px; border-bottom: 1px solid #e2e8f0; color: #334155; font-weight: 500; }
        
        /* HEATMAP CLASSES (Generadas por el Ingeniero) */
        .score-box { 
            padding: 4px 8px; border-radius: 4px; font-weight: 700; text-align: center; display: inline-block; width: 30px;
        }
        .hm-critico { background: var(--risk-bg); color: var(--risk-txt); }
        .hm-alerta { background: var(--warn-bg); color: var(--warn-txt); }
        .hm-optimo { background: var(--safe-bg); color: var(--safe-txt); }

        /* BOT√ìN FLOTANTE */
        .fab {
            position: fixed; bottom: 30px; right: 30px;
            background: var(--brand-blue); color: white;
            padding: 15px 30px; border-radius: 50px;
            font-weight: 700; box-shadow: 0 10px 25px rgba(37, 99, 235, 0.4);
            border: none; cursor: pointer; transition: transform 0.2s; z-index: 1000;
        }
        .fab:hover { transform: scale(1.05); }

        /* --- MODO IMPRESI√ìN PRO --- */
        @media print {
            body { background: white; padding: 0; gap: 0; }
            .page { 
                box-shadow: none; margin: 0; width: 100%; height: auto; 
                page-break-after: always; /* Fuerza hoja nueva */
            }
            .page:last-child { page-break-after: auto; }
            .fab { display: none; }
            /* Ajustes de color para impresoras */
            .cover-page { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .hm-critico, .hm-alerta, .hm-optimo { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>

    <div class="page cover-page">
        <div>
            <img src="https://raw.githubusercontent.com/profeangel96-bit/PLANTILLA/main/Gemini_Generated_Image_24c84124c84124c8.png" class="cover-logo">
            <div style="font-size: 14px; letter-spacing: 2px; opacity: 0.8; margin-bottom: 10px;">INFORME OFICIAL CONFIDENCIAL</div>
            <div class="cover-title">INTELIGENCIA<br>ESTRAT√âGICA<br>EDUCATIVA</div>
            <div class="cover-subtitle">An√°lisis de rendimiento y proyecci√≥n de calidad basada en datos.</div>
        </div>
        <div class="cover-footer">
            <div>
                <strong>PREPARADO PARA:</strong><br>
                <span id="cover-muni">ALCALD√çA MUNICIPAL</span>
            </div>
            <div style="text-align: right;">
                <strong>FECHA DE CORTE:</strong><br>
                16 DE ENERO DE 2026
            </div>
        </div>
    </div>

    <div class="page intro-page">
        <div class="intro-quote">"Lo que no se mide, no se puede mejorar."</div>
        <div class="intro-text">
            <p><strong>A la atenci√≥n de la Secretar√≠a de Educaci√≥n y Rector√≠a:</strong></p>
            <p>
                El presente documento constituye el <strong>Informe T√©cnico de Resultados</strong> correspondiente al Simulacro S-11. 
                A diferencia de los reportes tradicionales, este an√°lisis emplea un motor de inteligencia de datos dise√±ado por 
                <strong>Academia Quijano</strong> para identificar no solo puntajes, sino tendencias, riesgos y oportunidades.
            </p>
            <p>
                En las siguientes p√°ginas encontrar√°:
            </p>
            <ul>
                <li>Un diagn√≥stico ejecutivo del estado actual del grupo.</li>
                <li>Mapeo de competencias mediante radar comparativo.</li>
                <li>La Matriz de Calor (Heatmap) que revela el desempe√±o individual detallado.</li>
            </ul>
            <p>
                Nuestro objetivo no es solo entregar n√∫meros, sino proveer una herramienta de toma de decisiones para elevar 
                los indicadores de calidad educativa del municipio.
            </p>
        </div>
        <div class="intro-signature">
            <div style="width: 200px; border-bottom: 2px solid var(--brand-dark); margin-bottom: 10px;"></div>
            <strong>DIRECCI√ìN DE PROYECTOS</strong><br>
            <span style="font-size: 12px; color: #64748b;">SISTEMA DE INTELIGENCIA QUIJANO</span>
        </div>
    </div>

    <div class="page dashboard-page">
        <div class="dash-header">
            <div>
                <h2 style="margin:0; font-size:24px; color:var(--brand-dark);">RESUMEN EJECUTIVO</h2>
                <span style="font-size:12px; color:#64748b;">VISI√ìN GENERAL DEL GRUPO</span>
            </div>
            <div class="pill" style="background:#eff6ff; color:var(--brand-blue); padding:5px 10px; border-radius:4px; font-weight:bold; font-size:11px;">
                SIMULACRO S-11
            </div>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-val" id="kpi-avg">0</div>
                <div class="kpi-lbl">Promedio Global</div>
            </div>
            <div class="kpi-card" style="border-color: var(--safe-bg);">
                <div class="kpi-val" style="color: var(--safe-txt);" id="kpi-exc">0%</div>
                <div class="kpi-lbl">Tasa de Excelencia</div>
            </div>
            <div class="kpi-card" style="border-color: var(--risk-bg);">
                <div class="kpi-val" style="color: var(--risk-txt);" id="kpi-ini">0%</div>
                <div class="kpi-lbl">√çndice de Riesgo</div>
            </div>
        </div>

        <div class="chart-section">
            <canvas id="radarChart"></canvas>
        </div>

        <div style="background: #f1f5f9; padding: 20px; border-radius: 8px; border-left: 5px solid var(--brand-gold);">
            <strong style="color: var(--brand-gold); text-transform: uppercase; font-size: 11px;">Insight de Inteligencia</strong>
            <p style="margin: 5px 0 0 0; font-size: 13px; color: #334155;" id="ai-insight">
                El an√°lisis de varianza sugiere consolidar las bases en <strong>Lectura Cr√≠tica</strong>. 
                El grupo muestra homogeneidad en Ciencias, pero dispersi√≥n alta en Ingl√©s.
            </p>
        </div>
    </div>

    <div class="page data-page">
        <div class="dash-header">
            <div>
                <h2 style="margin:0; font-size:20px;">MATRIZ DE RESULTADOS</h2>
                <span style="font-size:11px; color:#64748b;">DESGLOSE INDIVIDUAL + MAPA DE CALOR</span>
            </div>
        </div>

        <table class="master-table">
            <thead>
                <tr>
                    <th style="width:30px;">#</th>
                    <th>ID / Documento</th>
                    <th>Estudiante</th>
                    <th style="text-align:center;">LEC</th>
                    <th style="text-align:center;">MAT</th>
                    <th style="text-align:center;">SOC</th>
                    <th style="text-align:center;">CIE</th>
                    <th style="text-align:center;">ING</th>
                    <th style="text-align:center;">GLOBAL</th>
                </tr>
            </thead>
            <tbody id="students-body">
                </tbody>
        </table>
        
        <div style="margin-top: 20px; font-size: 10px; color: #94a3b8; text-align: center;">
            Documento generado con tecnolog√≠a web de alta precisi√≥n. Hash de seguridad: <span id="v-hash">---</span>
        </div>
    </div>

    <button class="fab" onclick="window.print()">üñ®Ô∏è IMPRIMIR INFORME</button>

    <script>
        // --- 1. L√ìGICA DE DATOS (URL) ---
        const p = new URLSearchParams(window.location.search);
        
        // Datos Portada
        document.getElementById('cover-muni').innerText = (p.get('muni') || 'ALCALD√çA').toUpperCase();
        document.getElementById('v-hash').innerText = p.get('v') || 'DEV-MODE';

        // Datos KPIs
        document.getElementById('kpi-avg').innerText = p.get('avg') || 0;
        document.getElementById('kpi-exc').innerText = (p.get('exc')||0) + "%";
        document.getElementById('kpi-ini').innerText = (p.get('ini')||0) + "%";

        // --- 2. RADAR CHART ---
        const ctx = document.getElementById('radarChart').getContext('2d');
        Chart.defaults.font.family = "'Inter', sans-serif";
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['LECTURA', 'MATEM√ÅTICAS', 'SOCIALES', 'CIENCIAS', 'INGL√âS'],
                datasets: [{
                    label: 'Puntaje Institucional',
                    data: [p.get('lec')||50, p.get('mat')||50, p.get('soc')||50, p.get('cie')||50, p.get('ing')||50],
                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    borderColor: '#2563eb',
                    borderWidth: 2,
                    pointBackgroundColor: '#0f172a'
                }]
            },
            options: { scales: { r: { beginAtZero: true, max: 100 } } }
        });

        // --- 3. GENERADOR DE TABLA (HEATMAP ENGINE) ---
        // Como no podemos pasar 500 alumnos por URL, aqu√≠ SIMULAMOS c√≥mo se ve la tabla llena
        // Cuando conectemos la base de datos real, esto se llenar√° solo.
        
        const mockStudents = [
            { id: '1085...', name: 'AGUIRRE DAVILA DANA', l: 71, m: 68, s: 70, c: 75, i: 80, g: 364 },
            { id: '1004...', name: 'ANACONA BOLA√ëOS ANDRES', l: 65, m: 50, s: 60, c: 55, i: 45, g: 275 },
            { id: '1082...', name: 'ARCOS NANDAR OSCAR', l: 40, m: 30, s: 45, c: 50, i: 35, g: 200 },
            { id: '1120...', name: 'BENAVIDES SOFIA', l: 80, m: 78, s: 75, c: 82, i: 85, g: 400 },
            { id: '1050...', name: 'CAICEDO JUAN ESTEBAN', l: 55, m: 45, s: 50, c: 52, i: 40, g: 242 },
            // ... (El script generar√° m√°s filas para demostrar el salto de p√°gina)
        ];

        // Funci√≥n del Ingeniero: Asigna color seg√∫n puntaje
        function getHeatClass(score) {
            if (score <= 45) return 'hm-critico';
            if (score <= 65) return 'hm-alerta';
            return 'hm-optimo';
        }

        const tbody = document.getElementById('students-body');

        // Generamos 25 filas de ejemplo para que veas el efecto
        let exampleList = [...mockStudents, ...mockStudents, ...mockStudents, ...mockStudents, ...mockStudents]; 

        exampleList.forEach((est, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${index + 1}</td>
                <td style="font-family:monospace; color:#64748b;">${est.id}</td>
                <td><strong>${est.name}</strong></td>
                <td style="text-align:center;"><span class="score-box ${getHeatClass(est.l)}">${est.l}</span></td>
                <td style="text-align:center;"><span class="score-box ${getHeatClass(est.m)}">${est.m}</span></td>
                <td style="text-align:center;"><span class="score-box ${getHeatClass(est.s)}">${est.s}</span></td>
                <td style="text-align:center;"><span class="score-box ${getHeatClass(est.c)}">${est.c}</span></td>
                <td style="text-align:center;"><span class="score-box ${getHeatClass(est.i)}">${est.i}</span></td>
                <td style="text-align:center;"><strong>${est.g}</strong></td>
            `;
            tbody.appendChild(tr);
        });

    </script>
</body>
</html>
